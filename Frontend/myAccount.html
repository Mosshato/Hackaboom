<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <title>Cont</title>
  <style>
    /* Stilul CSS rămâne același */
    body {
      background-color: #f8f9fa;
      font-family: 'Arial', sans-serif;
      margin: 0;
    }

    .container {
      height: auto;  /* Permite ca containerul să se ajusteze la conținut */
      display: flex;
      flex-direction: column;  /* Asigură că secțiunile sunt plasate vertical */
      justify-content: flex-start;  /* Plasează conținutul la începutul containerului */
      align-items: center;
      text-align: center;
      margin: 0;  /* Elimină marginea automată */
      padding-top: 100px;
    }

    .myprofile-container {
      background: #ffffff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 400px;
      margin-bottom: 20px;  /* Adaugă un mic spațiu între profil și anunțuri */
    }

    .announcements-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;  /* Folosește 2 coloane pentru anunțuri */
      gap: 20px;  /* Adaugă spațiu între carduri */
      width: 100%;
      padding: 20px;
      box-sizing: border-box; /* Asigură că padding-ul nu afectează dimensiunea totală */
    }


    h4 {
      margin-bottom: 15px;
      font-weight: bold;
      text-align: left; /* Asigură-te că fiecare h4 este aliniat la stânga */
      margin-left: 10px; /* Adaugă un mic spațiu pentru aspect mai bun */
    }

    h1 {
      color: black;
      font-size: 2rem; /* Larger font for better readability */
      margin-bottom: 30px;
      word-wrap: break-word;
      font-weight: bold;
    }
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: #252424;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      color: white;
    }

    .searchbar input {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 500px;
    }

    .buttons {
      display: flex;
      gap: 10px;
    }

    .buttons button {
      display: flex;
      align-items: center;
      gap: 5px;  /* Spațiu între iconiță și text */
      padding: 8px 12px;
      border: none;
      background-color: #605c5c;
      color: white;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .delete-btn {
      bottom: 20px; /* Poziționează butonul la 20px de jos */
      width: 70px;
      height: 30px;
      border-radius: 10%;
      background-color: #605c5c;
      color: white;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      transition: background-color 0.3s ease-in-out;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }


    .buttons button:hover {
      background-color: black;
    }

    .material-icons {
      font-size: 20px;  /* Ajustează dimensiunea iconiței */
    }
    .round-button {
      position: fixed; /* Fixează butonul pe ecran */
      bottom: 20px; /* Poziționează butonul la 20px de jos */
      left: 20px; /* Poziționează butonul la 20px de stânga */
      z-index: 1000; /* Asigură-te că butonul este deasupra altor elemente */
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: #605c5c;
      color: white;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      transition: background-color 0.3s ease-in-out;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    .round-button:active {
      background-color: black;
    }
  </style>
</head>
<body>
<div class="navbar">
  <div class="logo">JustInTime</div>

  <div class="searchbar">
    <input type="text" placeholder="Căutare...">
  </div>

  <div class="buttons">
    <button><i class="material-icons">favorite</i> Favorite</button>
    <button><i class="material-icons">chat_bubble</i> Mesaje</button>
    <button id="mapButton"><i class="material-icons">pin_drop</i> Harta</button>
    <button><i class="material-icons">library_add</i> Adaugă Anunț</button>
    <button><i class="material-icons">person</i> Cont</button>
  </div>
</div>
<div class="container">
  <div class="myprofile-container">
    <h1>Contul meu</h1>

    <h4 id="username">Nume utilizator:</h4>
    <h4 id="email">Email:</h4>
    <h4 id="hours">Ore adunate:</h4>
    <h4 id="location">Locatie:</h4>
  </div>
</div>
<div class="container">
  <h2>Anunțuri publicate</h2>
  <div id="announcements" class="announcements-grid"></div>
</div>
<div class="wrapper">
  <div id="map"></div>
  <button class="round-button" id="backButton">
    <i class="material-icons">arrow_back_ios</i>
  </button>
</div>
<script>
  // Funcție pentru a prelua datele utilizatorului de la API
  async function fetchUserData() {
    const email = localStorage.getItem('email'); // Luăm email-ul din localStorage
    console.log(email);
    if (!email) {
      console.error('Email-ul nu a fost găsit în localStorage!');
      return;
    }

    try {
      const response = await fetch(`http://localhost:5000/user/myAccount?email=${encodeURIComponent(email)}`, {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      });

      const data = await response.json();
      console.log(data);
      if (!response.ok) {
        console.error('Eroare la preluarea datelor:', data.message);
        return;
      }

      // ✅ Atribuie valorile datelor din API la elementele HTML
      document.getElementById('username').innerText = 'Nume utilizator: ' + data.username;
      document.getElementById('email').innerText = 'Email: ' + data.email;
      document.getElementById('hours').innerText = 'Ore adunate: ' + data.oreAdunate;
      document.getElementById('location').innerText = 'Locație: ' + data.locatie;

      const announcementsContainer = document.getElementById('announcements');
      announcementsContainer.innerHTML = ''; // Curățăm orice conținut anterior

      if (data.announcements && data.announcements.length > 0) {
        data.announcements.forEach(ad => {
          const card = document.createElement('div');
          card.classList.add('announcement-card');

          // Fiecare anunț va afișa numele, descrierea și prețul
          card.innerHTML = `
          <h3>${ad.name}</h3>
          <p>${ad.description}</p>
          <p>Pret: ${ad.price} ore</p>
          <button class="delete-btn" data-id="${ad._id}">Șterge</button>
        `;

          announcementsContainer.appendChild(card);
        });
      } else {
        announcementsContainer.innerHTML = '<p>Nu ai anunțuri publicate.</p>';
      }

    } catch (error) {
      console.error('Eroare la preluarea datelor:', error);
    }
  }


  // Apelează funcția pentru a prelua datele atunci când pagina este încărcată
  window.onload = fetchUserData;
</script>
<script>
  document.getElementById("backButton").addEventListener("click", function() {
    window.location.href = "main.html";
  });
</script>
</body>
</html>
